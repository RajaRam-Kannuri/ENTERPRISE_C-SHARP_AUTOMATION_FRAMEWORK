{"Value":null,"VariableID":1528412454,"Favorite":false,"UsesSQL":true,"SqlScript":"Use Sufs\r\n \r\nDECLARE @OrganizationYearID INT = 17  \r\n \r\nSELECT TOP 100 AU.UserName AS 'Email', MS.[Description] AS 'Marital Status', \r\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND HouseholdMemberTypeID IN (1,2)) AS '# of Parents',\r\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND HouseholdMemberTypeID = 3) AS '# of Students',\r\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND HouseholdMemberTypeID = 5) AS '# of Other Adults',\r\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND HouseholdMemberTypeID = 4) AS '# of Children',\r\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND (IsFosterChild = 1 OR IsOutOfHome = 1)) AS '# of Foster/OOHC',\r\nHM.FirstName,\r\nGL.[Description] AS 'Grade Level'\r\nFROM dbo.[Application] A\r\nJOIN dbo.Household H ON H.ApplicationID = A.ApplicationID\r\nJOIN dbo.HouseholdMember Adult ON Adult.HouseholdID = H.HouseholdID AND Adult.HouseholdMemberTypeID = 1\r\nJOIN dbo.MaritalStatus MS ON MS.MaritalStatusID = Adult.MaritalStatusID\r\nJOIN dbo.HouseholdMember HM ON HM.HouseholdID = H.HouseholdID\r\nJOIN dbo.Student S ON S.HouseholdMemberID = HM.HouseholdMemberID\r\nJOIN dbo.GradeLevel GL ON GL.GradeLevelID = S.GradeLevelID\r\nJOIN dbo.UserApplication UA ON UA.ApplicationID = A.ApplicationID\r\nJOIN dbo.UserMap UM ON UA.UserID = UM.UserID\r\nJOIN dbo.aspnet_Users AU ON AU.UserId = UM.UserId_Membership\r\nJOIN dbo.StudentSchool SS ON SS.HouseholdMemberID = S.HouseholdMemberID\r\nJOIN dbo.StudentSchoolVerificationPeriod SSVP ON SSVP.StudentSchoolID = SS.StudentSchoolID \r\n    AND SSVP.CertificationStatusID = 2 AND SSVP.IsEnrolled = 1\r\nWHERE A.OrganizationYearID = @OrganizationYearID AND AU.UserName LIKE '%@%' \r\n    AND A.ApplicationStatusID = 23 \r\n    AND A.ApplicationID NOT IN (SELECT PreviousYearApplicationID FROM dbo.[Application] WHERE PreviousYearApplicationID IS NOT NULL)\r\n    AND (SELECT COUNT(1) FROM dbo.[APPLICATION] lApp\r\n            join household lHousehold on lApp.applicationId = lHousehold.applicationId \r\n            join householdmember lHouseholdMember on lHousehold.householdId = lHouseholdMember.householdId\r\n        WHERE lApp.OrganizationYearId = (@organizationYearid + 1) AND lHouseholdMember.emailAddress = Adult.EmailAddress) = 0\r\nORDER BY NEWID()","SqlServer":"dev-sqlc1n1\\test","SqlServerUAT":"","SqlColumn":"Email","SqlRow":1,"Note":null,"Name":"FTC-OLA_FindRenewalApplication","DateModified":null,"Description":null,"Browser":"Chrome","Environment":"Test","ServerEnvironment":"Test"}