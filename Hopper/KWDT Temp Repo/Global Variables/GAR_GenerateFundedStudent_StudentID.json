{"Value":null,"VariableID":1151341425,"Favorite":false,"UsesSQL":true,"SqlScript":"use plsa\r\n\r\nSELECT EmailAddress, StudentID, HasBankingInfo, [2014], [2015], [2016], [2017], [2018]\r\nFrom (\r\nSelect Distinct\r\n hm2.EmailAddress,\r\n sa.StudentID,\r\n sa.CurrentYearFunded - sa.CurrentYearPaid AS AmountLeft,\r\n sa.Year,\r\n Case When bat.[Description] Is Not Null Then 1 Else 0 End as HasBankingInfo\r\nFrom SAPAwards.ECSB1_StudentAccounts sa\r\nJoin dbo.HouseholdMember hm On hm.PersonID = sa.StudentID\r\nJOIN dbo.Student S ON S.HouseholdMemberID = hm.HouseholdMemberID AND S.StudentScholarshipStatusID <> 17\r\nJoin dbo.Household h On h.HouseholdID = hm.HouseholdID\r\nJoin dbo.HouseholdMember hm2 On hm2.HouseholdID = h.HouseholdID And hm2.HouseholdMemberTypeID = 1\r\nJoin dbo.aspnet_Membership aspMem On aspMem.Email = hm2.EmailAddress\r\nJoin dbo.UserApplication ua On ua.ApplicationID = h.ApplicationID\r\nLeft Join dbo.BankAccount ba On ba.UserID = ua.UserID\r\nLeft Join dbo.BankAccountType bat On bat.BankAccountTypeID = ba.BankAccountTypeID\r\nWhere sa.CurrentYearFunded > sa.CurrentYearPaid and bat.[Description] Is Not Null AND sa.[Year] = 2017\r\n) as source\r\nPivot (\r\n Max(AmountLeft) For Year In ([2013], [2014], [2015], [2016], [2017], [2018])\r\n) as pvt\r\nWHERE [2017] > 100\r\nORDER BY NEWID()\r\n","SqlServer":null,"SqlColumn":"StudentID","SqlRow":1,"Note":null,"Name":"GAR_GenerateFundedStudent_StudentID","DateModified":null,"Description":null,"Browser":"Chrome","Environment":"Test"}