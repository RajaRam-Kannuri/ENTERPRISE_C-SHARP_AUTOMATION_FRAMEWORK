{"Value":null,"VariableID":112124547,"Favorite":false,"UsesSQL":true,"SqlScript":"Use Sufs\n\nDECLARE @OrganizationYearID INT = 17  --Specify year here \n                                      -- put in the previous year  IE if looking for families who have not applied 19-20 put in 17\n\nSELECT DISTINCT AU.UserName AS 'Email', MS.[Description] AS 'Marital Status', \n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND HouseholdMemberTypeID IN (1,2)) AS '# of Parents',\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND HouseholdMemberTypeID = 3) AS '# of Students',\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND HouseholdMemberTypeID = 5) AS '# of Other Adults',\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND HouseholdMemberTypeID = 4) AS '# of Children',\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND (IsFosterChild = 1 OR IsOutOfHome = 1)) AS '# of Foster/OOHC',\nHM.FirstName,\nGL.[Description] AS 'Grade Level'\nFROM dbo.[Application] A\nJOIN dbo.Household H ON H.ApplicationID = A.ApplicationID\nJOIN dbo.HouseholdMember Adult ON Adult.HouseholdID = H.HouseholdID AND Adult.HouseholdMemberTypeID = 1\nJOIN dbo.MaritalStatus MS ON MS.MaritalStatusID = Adult.MaritalStatusID\nJOIN dbo.HouseholdMember HM ON HM.HouseholdID = H.HouseholdID\nJOIN dbo.Student S ON S.HouseholdMemberID = HM.HouseholdMemberID\nJOIN dbo.GradeLevel GL ON GL.GradeLevelID = S.GradeLevelID\nJOIN dbo.UserApplication UA ON UA.ApplicationID = A.ApplicationID\nJOIN dbo.UserMap UM ON UA.UserID = UM.UserID\nJOIN dbo.aspnet_Users AU ON AU.UserId = UM.UserId_Membership\nJOIN dbo.StudentSchool SS ON SS.HouseholdMemberID = S.HouseholdMemberID\nJOIN dbo.StudentSchoolVerificationPeriod SSVP ON SSVP.StudentSchoolID = SS.StudentSchoolID \n AND SSVP.CertificationStatusID = 2 AND SSVP.IsEnrolled = 1\nWHERE A.OrganizationYearID = @OrganizationYearID AND AU.UserName LIKE '%@%' \nAND A.ApplicationStatusID = 23 AND A.ApplicationID NOT IN\n(SELECT PreviousYearApplicationID FROM dbo.[Application] WHERE PreviousYearApplicationID IS NOT NULL)\nORDER BY AU.UserName","SqlServer":"dev-sqlc1n1\\test","SqlServerUAT":"dev-sqlc1n1\\uat","SqlServerTraining":null,"SqlColumn":"Email","SqlRow":1,"Note":"Email address as user name","Name":"FTC-OLA_GenericUserName","DateModified":null,"Description":null,"Program":"FTC","Browser":"Chrome","Environment":"Test","ServerEnvironment":"Test"}