{"Value":null,"VariableID":162302327,"Favorite":false,"UsesSQL":true,"SqlScript":"Use Sufs\n\nDECLARE @OrganizationYearID INT = 17 \n\nSELECT * FROM (SELECT DISTINCT AU.UserName AS 'Email', MS.[Description] AS 'Marital Status', \n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND HouseholdMemberTypeID IN (1,2)) AS NumOfParents,\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND HouseholdMemberTypeID = 3) AS NumOfStudents,\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND HouseholdMemberTypeID = 5) AS NumOfOtherAdults,\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND HouseholdMemberTypeID = 4) AS NumOfChildren,\n(SELECT COUNT(1) FROM dbo.HouseholdMember WHERE HouseholdID = H.HouseholdID AND (IsFosterChild = 1 OR IsOutOfHome = 1)) AS NumOfFoster, HM.FirstName, GL.[Description] AS 'Grade Level'\nFROM dbo.[Application] A\nJOIN dbo.Household H ON H.ApplicationID = A.ApplicationID\nJOIN dbo.HouseholdMember Adult ON Adult.HouseholdID = H.HouseholdID AND Adult.HouseholdMemberTypeID = 1\nJOIN dbo.MaritalStatus MS ON MS.MaritalStatusID = Adult.MaritalStatusID\nJOIN dbo.HouseholdMember HM ON HM.HouseholdID = H.HouseholdID\nJOIN dbo.Student S ON S.HouseholdMemberID = HM.HouseholdMemberID\nJOIN dbo.GradeLevel GL ON GL.GradeLevelID = S.GradeLevelID\nJOIN dbo.UserApplication UA ON UA.ApplicationID = A.ApplicationID\nJOIN dbo.UserMap UM ON UA.UserID = UM.UserID\nJOIN dbo.aspnet_Users AU ON AU.UserId = UM.UserId_Membership\nJOIN dbo.StudentSchool SS ON SS.HouseholdMemberID = S.HouseholdMemberID\nJOIN dbo.StudentSchoolVerificationPeriod SSVP ON SSVP.StudentSchoolID = SS.StudentSchoolID \n AND SSVP.CertificationStatusID = 2 AND SSVP.IsEnrolled = 1\n WHERE A.OrganizationYearID = @OrganizationYearID AND AU.UserName LIKE '%@%' \n  AND A.ApplicationStatusID = 23 AND A.ApplicationID NOT IN\n  (SELECT PreviousYearApplicationID FROM dbo.[Application] WHERE PreviousYearApplicationID IS NOT NULL)\n) AS TEMP\n\nWHERE NumOfStudents = 4\nOrder by NEWID()","SqlServer":"dev-sqlc1n1\\test","SqlColumn":"Email","SqlRow":1,"Note":null,"Name":"FTC-OLA_FindRenewalApplicationWith4Students-old","DateModified":null,"Description":null,"Browser":"Chrome","Environment":"Test"}